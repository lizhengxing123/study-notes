<!--
 * @Descripttion: 
 * @Author: lizhengxing
 * @Date: 2022-10-18 21:32:21
 * @LastEditTime: 2022-10-18 21:46:56
-->

## 变量在内存中的布局

`Solidity` 保留了4个32字节的插槽，字节范围特定用途如下

- `0x00`～`0x3f`(64字节)：用于哈希方法的暂存空间（临时空间）
- `0x40`～`0x5f`(32字节)：当前分配的内存大小（也作为空闲内存指针）
- `0x60`～`0x7f`(32字节)：零位插槽

暂存空间可以在语句之中使用（例如在內联汇编中），零位插槽用作动态内存数组的初始值，并且永远不应写入。空闲内存指针最初指向`0x80`。

`Solidity`总是将新对象放在空闲内存指针上，并且内存永远不会被释放。

内存数组的元素始终占据32字节的倍数（例如`bytes1[]`，但不适用于`string`和`bytes`）。

多维内存数组是指向内存数组的指针，动态数组的长度存储在第一个槽位，然后是数组元素。

```solidity
// 在存储中占32字节，一个槽
// 在内存中占128字节，4个槽
uint8[4] x;
// 在存储中占96，3个槽
// 在内存中占128字节，4个槽
struct S {
    uint a;
    uint b;
    uint8 c;
    uint8 d;
}
```